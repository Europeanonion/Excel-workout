FAIL src/components/ProgramList/ProgramList.test.tsx
  ● C  console.error
    Warning: `ReactDOMTestUtils.act` is deprecated in favor of `React.act`. Import `act` from `react` instead of `react-dom/test-utils`. See https://react.dev/warnings/react-dom-test-utils for more info.

      18 |
      19 |   it('renders upload button and help text', () => {
    > 20 |     render(<ExcelUploader />);
         |           ^
      21 |     
      22 |     expect(screen.getByLabelText('Choose Excel file')).toBeInTheDocument();
      23 |     expect(screen.getByText('Choose Excel File')).toBeInTheDocument();

      at printWarning (node_modules/react-dom/cjs/react-dom-test-utils.development.js:71:30)
      at error (node_modules/react-dom/cjs/react-dom-test-utils.development.js:45:7)
      at actWithWarning (node_modules/react-dom/cjs/react-dom-test-utils.development.js:1736:7)
      at node_modules/@testing-library/react/dist/act-compat.js:63:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:159:26)
      at render (node_modules/@testing-library/react/dist/pure.js:246:10)
      at Object.<anonymous> (src/components/ExcelUploader/ExcelUploader.test.tsx:20:11)
      at TestScheduler.scheduleTests (node_modules/@jest/core/build/TestScheduler.js:333:13)
      at runJest (node_modules/@jest/core/build/runJest.js:404:19)

  console.error
    Warning: An update to ExcelUploader inside a test was not wrapped in act(...).
    
    When testing, code that causes React state updates should be wrapped into act(...):
    
    act(() => {
      /* fire events that update state */
    });
    /* assert on the output */
    
    This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
        at ExcelUploader (/workspaces/Excel-workout/src/components/ExcelUploader/ExcelUploader.tsx:11:3)

      43 |       onUploadError?.(err instanceof Error ? err : new Error(message));
      44 |     } finally {
    > 45 |       setIsLoading(false);
         |       ^
      46 |     }
      47 |   }, [onUploadSuccess, onUploadError]);
      48 |

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at setIsLoading (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at src/components/ExcelUploader/ExcelUploader.tsx:45:7

FAIL src/components/ExcelUploader/ExcelUploader.test.tsx
  ExcelUploader
    ✓ renders upload button and help text (51 ms)
    ✓ shows loading state while processing (113 ms)
    ✓ handles successful file upload (8 ms)
    ✕ handles invalid file type (3 ms)
    ✕ handles parsing errors (4 ms)
    ✓ clears the input after successful upload (20 ms)

  ● ExcelUploader › handles invalid file type

    ReferenceError: act is not defined

      67 |     const file = new File([''], 'test.txt', { type: 'text/plain' });
      68 |     
    > 69 |     await act(async () => {
         |     ^
      70 |       fireEvent.change(input, { target: { files: [file] } });
      71 |     });
      72 |     

      at Object.<anonymous> (src/components/ExcelUploader/ExcelUploader.test.tsx:69:5)
      at TestScheduler.scheduleTests (node_modules/@jest/core/build/TestScheduler.js:333:13)
      at runJest (node_modules/@jest/core/build/runJest.js:404:19)

  ● ExcelUploader › handles parsing errors

    ReferenceError: act is not defined

      104 |     const file = new File([''], 'test.xlsx', { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
      105 |     
    > 106 |     await act(async () => {
          |     ^
      107 |       fireEvent.change(input, { target: { files: [file] } });
      108 |     });
      109 |     

      at Object.<anonymous> (src/components/ExcelUploader/ExcelUploader.test.tsx:106:5)
      at TestScheduler.scheduleTests (node_modules/@jest/core/build/TestScheduler.js:333:13)
      at runJest (node_modules/@jest/core/build/runJest.js:404:19)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 4 passed, 6 total
Snapshots:   0 total
Time:        2.527 s
Ran all test suites related to changed files.

                 [33mclass[39m=[32m"programName"[39m
                [36m>[39m
                  [0mTest Program 1[0m
                [36m</h3>[39m
                [36m<span[39m
                  [33mclass[39m=[32m"workoutCount"[39m
                [36m>[39m
                  [0m1[0m
                  [0m workouts[0m
                [36m</span>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"programStats"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"stat"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"statLabel"[39m
                  [36m>[39m
                    [0mLast workout:[0m
                  [36m</span>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"statValue"[39m
                  [36m>[39m
                    [0m2/22/2025[0m
                  [36m</span>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"stat"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"statLabel"[39m
                  [36m>[39m
                    [0mCompleted:[0m
                  [36m</span>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"statValue"[39m
                  [36m>[39m
                    [0m1[0m
                    [0m sessions[0m
                  [36m</span>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<button[39m
                [33maria-label[39m=[32m"View Test Program 1 details"[39m
                [33mclass[39m=[32m"viewButton"[39m
              [36m>[39m
                [0mView Program[0m
              [36m</button>[39m
            [36m</li>[39m
            [36m<li[39m
              [33mclass[39m=[32m"item"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"programHeader"[39m
              [36m>[39m
                [36m<h3[39m
                  [33mclass[39m=[32m"programName"[39m
                [36m>[39m
                  [0mTest Program 2[0m
                [36m</h3>[39m
                [36m<span[39m
                  [33mclass[39m=[32m"workoutCount"[39m
                [36m>[39m
                  [0m1[0m
                  [0m workouts[0m
                [36m</span>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"programStats"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"stat"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"statLabel"[39m
                  [36m>[39m
                    [0mLast workout:[0m
                  [36m</span>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"statValue"[39m
                  [36m>[39m
                    [0mNot started[0m
                  [36m</span>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"stat"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"statLabel"[39m
                  [36m>[39m
                    [0mCompleted:[0m
                  [36m</span>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"statValue"[39m
                  [36m>[39m
                    [0m0[0m
                    [0m sessions[0m
                  [36m</span>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<button[39m
                [33maria-label[39m=[32m"View Test Program 2 details"[39m
                [33mclass[39m=[32m"viewButton"[39m
              [36m>[39m
                [0mView Program[0m
              [36m</button>[39m
            [36m</li>[39m
          [36m</ul>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      89 |     render(<ProgramList />);
      90 |     
    > 91 |     await waitFor(() => {
         |                  ^
      92 |       // Check program names are displayed
      93 |       expect(screen.getByText('Test Program 1')).toBeInTheDocument();
      94 |       expect(screen.getByText('Test Program 2')).toBeInTheDocument();

      at waitForWrapper (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/wait-for.js:166:27)
      at Object.<anonymous> (src/components/ProgramList/ProgramList.test.tsx:91:18)

FAIL src/App.test.tsx
  ● Console

    console.error
      Warning: `ReactDOMTestUtils.act` is deprecated in favor of `React.act`. Import `act` from `react` instead of `react-dom/test-utils`. See https://react.dev/warnings/react-dom-test-utils for more info.

      21 |
      22 |   it('renders header and both components', () => {
    > 23 |     render(<App />);
         |           ^
      24 |     
      25 |     // Header
      26 |     expect(screen.getByText('Excel Workout PWA')).toBeInTheDocument();

      at printWarning (node_modules/react-dom/cjs/react-dom-test-utils.development.js:71:30)
      at error (node_modules/react-dom/cjs/react-dom-test-utils.development.js:45:7)
      at actWithWarning (node_modules/react-dom/cjs/react-dom-test-utils.development.js:1736:7)
      at node_modules/@testing-library/react/dist/act-compat.js:63:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:159:26)
      at render (node_modules/@testing-library/react/dist/pure.js:246:10)
      at Object.<anonymous> (src/App.test.tsx:23:11)

    console.error
      Warning: An update to ProgramList inside a test was not wrapped in act(...).
      
      When testing, code that causes React state updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at ProgramList (/workspaces/Excel-workout/src/components/ProgramList/ProgramList.tsx:7:43)
          at section
          at main
          at div
          at App (/workspaces/Excel-workout/src/App.tsx:7:41)

      13 |       try {
      14 |         const loadedPrograms = await getAllWorkoutPrograms();
    > 15 |         setPrograms(loadedPrograms);
         |         ^
      16 |       } catch (err) {
      17 |         setError('Failed to load workout programs. Please try again later.');
      18 |         console.error('Error loading programs:', err);

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at setPrograms (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at loadPrograms (src/components/ProgramList/ProgramList.tsx:15:9)

    console.error
      Warning: An update to ProgramList inside a test was not wrapped in act(...).
      
      When testing, code that causes React state updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at ProgramList (/workspaces/Excel-workout/src/components/ProgramList/ProgramList.tsx:7:43)
          at section
          at main
          at div
          at App (/workspaces/Excel-workout/src/App.tsx:7:41)

      18 |         console.error('Error loading programs:', err);
      19 |       } finally {
    > 20 |         setIsLoading(false);
         |         ^
      21 |       }
      22 |     };
      23 |

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at setIsLoading (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at loadPrograms (src/components/ProgramList/ProgramList.tsx:20:9)

    console.error
      Warning: An update to ProgramList inside a test was not wrapped in act(...).
      
      When testing, code that causes React state updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at ProgramList (/workspaces/Excel-workout/src/components/ProgramList/ProgramList.tsx:7:43)
          at section
          at main
          at div
          at App (/workspaces/Excel-workout/src/App.tsx:7:41)

      13 |       try {
      14 |         const loadedPrograms = await getAllWorkoutPrograms();
    > 15 |         setPrograms(loadedPrograms);
         |         ^
      16 |       } catch (err) {
      17 |         setError('Failed to load workout programs. Please try again later.');
      18 |         console.error('Error loading programs:', err);

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at setPrograms (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at loadPrograms (src/components/ProgramList/ProgramList.tsx:15:9)

    console.error
      Warning: An update to ProgramList inside a test was not wrapped in act(...).
      
      When testing, code that causes React state updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at ProgramList (/workspaces/Excel-workout/src/components/ProgramList/ProgramList.tsx:7:43)
          at section
          at main
          at div
          at App (/workspaces/Excel-workout/src/App.tsx:7:41)

      18 |         console.error('Error loading programs:', err);
      19 |       } finally {
    > 20 |         setIsLoading(false);
         |         ^
      21 |       }
      22 |     };
      23 |

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at setIsLoading (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at loadPrograms (src/components/ProgramList/ProgramList.tsx:20:9)

    console.error
      Warning: An update to ProgramList inside a test was not wrapped in act(...).
      
      When testing, code that causes React state updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at ProgramList (/workspaces/Excel-workout/src/components/ProgramList/ProgramList.tsx:7:43)
          at section
          at main
          at div
          at App (/workspaces/Excel-workout/src/App.tsx:7:41)

      13 |       try {
      14 |         const loadedPrograms = await getAllWorkoutPrograms();
    > 15 |         setPrograms(loadedPrograms);
         |         ^
      16 |       } catch (err) {
      17 |         setError('Failed to load workout programs. Please try again later.');
      18 |         console.error('Error loading programs:', err);

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at setPrograms (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at loadPrograms (src/components/ProgramList/ProgramList.tsx:15:9)

    console.error
      Warning: An update to ProgramList inside a test was not wrapped in act(...).
      
      When testing, code that causes React state updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at ProgramList (/workspaces/Excel-workout/src/components/ProgramList/ProgramList.tsx:7:43)
          at section
          at main
          at div
          at App (/workspaces/Excel-workout/src/App.tsx:7:41)

      18 |         console.error('Error loading programs:', err);
      19 |       } finally {
    > 20 |         setIsLoading(false);
         |         ^
      21 |       }
      22 |     };
      23 |

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at setIsLoading (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at loadPrograms (src/components/ProgramList/ProgramList.tsx:20:9)

  ● App › renders header and both components

    TestingLibraryElementError: Unable to find an element with the text: No workout programs found.. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"App"[39m
        [36m>[39m
          [36m<header[39m
            [33mclass[39m=[32m"App-header"[39m
          [36m>[39m
            [36m<h1>[39m
              [0mExcel Workout PWA[0m
            [36m</h1>[39m
            [36m<p>[39m
              [0mTrack and manage your workout programs[0m
            [36m</p>[39m
          [36m</header>[39m
          [36m<main[39m
            [33mclass[39m=[32m"App-main"[39m
          [36m>[39m
            [36m<section[39m
              [33mclass[39m=[32m"App-section"[39m
            [36m>[39m
              [36m<h2[39m
                [33mclass[39m=[32m"section-title"[39m
              [36m>[39m
                [0mUpload Program[0m
              [36m</h2>[39m
              [36m<div[39m
                [33maria-label[39m=[32m"Excel file upload"[39m
                [33mclass[39m=[32m"container"[39m
                [33mrole[39m=[32m"region"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"uploadLabel"[39m
                [36m>[39m
                  [36m<input[39m
                    [33maccept[39m=[32m".xlsx,.xls"[39m
                    [33maria-label[39m=[32m"Choose Excel file"[39m
                    [33mclass[39m=[32m"fileInput"[39m
                    [33mtype[39m=[32m"file"[39m
                  [36m/>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"uploadButton"[39m
                  [36m>[39m
                    [0mChoose Excel File[0m
                  [36m</span>[39m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"helpText"[39m
                [36m>[39m
                  [0mSupported formats: .xlsx, .xls[0m
                [36m</div>[39m
              [36m</div>[39m
            [36m</section>[39m
            [36m<section[39m
              [33mclass[39m=[32m"App-section"[39m
            [36m>[39m
              [36m<div[39m
                [33maria-label[39m=[32m"Loading workout programs"[39m
                [33mclass[39m=[32m"loading"[39m
                [33mrole[39m=[32m"status"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"spinner"[39m
                [36m/>[39m
                [36m<span[39m
                  [33mclass[39m=[32m"loadingText"[39m
                [36m>[39m
                  [0mLoading programs...[0m
                [36m</span>[39m
              [36m</div>[39m
            [36m</section>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      32 |     
      33 |     // Program list section (empty state)
    > 34 |     expect(screen.getByText('No workout programs found.')).toBeInTheDocument();
         |                   ^
      35 |   });
      36 |
      37 |   it('shows success message and refreshes program list after successful upload', async () => {

      at Object.getElementError (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at getByText (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:95:19)
      at Object.<anonymous> (src/App.test.tsx:34:19)

  ● App › shows success message and refreshes program list after successful upload

    TestingLibraryElementError: Unable to find an element with the text: No workout programs found.. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"App"[39m
        [36m>[39m
          [36m<header[39m
            [33mclass[39m=[32m"App-header"[39m
          [36m>[39m
            [36m<h1>[39m
              [0mExcel Workout PWA[0m
            [36m</h1>[39m
            [36m<p>[39m
              [0mTrack and manage your workout programs[0m
            [36m</p>[39m
          [36m</header>[39m
          [36m<main[39m
            [33mclass[39m=[32m"App-main"[39m
          [36m>[39m
            [36m<section[39m
              [33mclass[39m=[32m"App-section"[39m
            [36m>[39m
              [36m<h2[39m
                [33mclass[39m=[32m"section-title"[39m
              [36m>[39m
                [0mUpload Program[0m
              [36m</h2>[39m
              [36m<div[39m
                [33maria-label[39m=[32m"Excel file upload"[39m
                [33mclass[39m=[32m"container"[39m
                [33mrole[39m=[32m"region"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"uploadLabel"[39m
                [36m>[39m
                  [36m<input[39m
                    [33maccept[39m=[32m".xlsx,.xls"[39m
                    [33maria-label[39m=[32m"Choose Excel file"[39m
                    [33mclass[39m=[32m"fileInput"[39m
                    [33mtype[39m=[32m"file"[39m
                  [36m/>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"uploadButton"[39m
                  [36m>[39m
                    [0mChoose Excel File[0m
                  [36m</span>[39m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"helpText"[39m
                [36m>[39m
                  [0mSupported formats: .xlsx, .xls[0m
                [36m</div>[39m
              [36m</div>[39m
            [36m</section>[39m
            [36m<section[39m
              [33mclass[39m=[32m"App-section"[39m
            [36m>[39m
              [36m<div[39m
                [33maria-label[39m=[32m"Loading workout programs"[39m
                [33mclass[39m=[32m"loading"[39m
                [33mrole[39m=[32m"status"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"spinner"[39m
                [36m/>[39m
                [36m<span[39m
                  [33mclass[39m=[32m"loadingText"[39m
                [36m>[39m
                  [0mLoading programs...[0m
                [36m</span>[39m
              [36m</div>[39m
            [36m</section>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      56 |     
      57 |     // Initially should show empty state
    > 58 |     expect(screen.getByText('No workout programs found.')).toBeInTheDocument();
         |                   ^
      59 |     
      60 |     // Upload file
      61 |     fireEvent.change(input, { target: { files: [file] } });

      at Object.getElementError (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at getByText (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:95:19)
      at Object.<anonymous> (src/App.test.tsx:58:19)

  ● App › shows error message when upload fails

    Unable to find role="status" and name "Failed to parse Excel file"

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"App"[39m
        [36m>[39m
          [36m<header[39m
            [33mclass[39m=[32m"App-header"[39m
          [36m>[39m
            [36m<h1>[39m
              [0mExcel Workout PWA[0m
            [36m</h1>[39m
            [36m<p>[39m
              [0mTrack and manage your workout programs[0m
            [36m</p>[39m
          [36m</header>[39m
          [36m<main[39m
            [33mclass[39m=[32m"App-main"[39m
          [36m>[39m
            [36m<section[39m
              [33mclass[39m=[32m"App-section"[39m
            [36m>[39m
              [36m<h2[39m
                [33mclass[39m=[32m"section-title"[39m
              [36m>[39m
                [0mUpload Program[0m
              [36m</h2>[39m
              [36m<div[39m
                [33maria-label[39m=[32m"Excel file upload"[39m
                [33mclass[39m=[32m"container"[39m
                [33mrole[39m=[32m"region"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"uploadLabel"[39m
                [36m>[39m
                  [36m<input[39m
                    [33maccept[39m=[32m".xlsx,.xls"[39m
                    [33maria-describedby[39m=[32m"upload-error"[39m
                    [33maria-label[39m=[32m"Choose Excel file"[39m
                    [33mclass[39m=[32m"fileInput"[39m
                    [33mtype[39m=[32m"file"[39m
                  [36m/>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"uploadButton"[39m
                  [36m>[39m
                    [0mChoose Excel File[0m
                  [36m</span>[39m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"helpText"[39m
                [36m>[39m
                  [0mSupported formats: .xlsx, .xls[0m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33maria-live[39m=[32m"polite"[39m
                [33mclass[39m=[32m"App-message error"[39m
                [33mrole[39m=[32m"status"[39m
              [36m>[39m
                [0mFailed to parse Excel file[0m
              [36m</div>[39m
            [36m</section>[39m
            [36m<section[39m
              [33mclass[39m=[32m"App-section"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"empty"[39m
                [33mrole[39m=[32m"status"[39m
              [36m>[39m
                [36m<p>[39m
                  [0mNo workout programs found.[0m
                [36m</p>[39m
                [36m<p>[39m
                  [0mUpload an Excel file to get started.[0m
                [36m</p>[39m
              [36m</div>[39m
            [36m</section>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      88 |     fireEvent.change(input, { target: { files: [file] } });
      89 |     
    > 90 |     await waitFor(() => {
         |                  ^
      91 |       const errorElement = screen.getByRole('status', { name: errorMessage });
      92 |       expect(errorElement).toBeInTheDocument();
      93 |       expect(errorElement).toHaveClass('App-message', 'error');

      at waitForWrapper (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/wait-for.js:166:27)
      at Object.<anonymous> (src/App.test.tsx:90:18)

  ● App › maintains proper section structure and accessibility

    expect(received).toHaveTextContent()

    received value must be a Node.
    Received has value: undefined

      102 |     expect(headings[0]).toHaveTextContent('Excel Workout PWA');
      103 |     expect(headings[1]).toHaveTextContent('Upload Program');
    > 104 |     expect(headings[2]).toHaveTextContent('Your Workout Programs');
          |                         ^
      105 |
      106 |     // Check section landmarks
      107 |     expect(screen.getByRole('banner')).toBeInTheDocument(); // header

      at __EXTERNAL_MATCHER_TRAP__ (node_modules/expect/build/index.js:386:30)
      at Object.toHaveTextContent (node_modules/expect/build/index.js:387:15)
      at Object.<anonymous> (src/App.test.tsx:104:25)

FAIL src/components/ExcelUploader/ExcelUploader.test.tsx
  ● Console

    console.error
      Warning: `ReactDOMTestUtils.act` is deprecated in favor of `React.act`. Import `act` from `react` instead of `react-dom/test-utils`. See https://react.dev/warnings/react-dom-test-utils for more info.

      18 |
      19 |   it('renders upload button and help text', () => {
    > 20 |     render(<ExcelUploader />);
         |           ^
      21 |     
      22 |     expect(screen.getByLabelText('Choose Excel file')).toBeInTheDocument();
      23 |     expect(screen.getByText('Choose Excel File')).toBeInTheDocument();

      at printWarning (node_modules/react-dom/cjs/react-dom-test-utils.development.js:71:30)
      at error (node_modules/react-dom/cjs/react-dom-test-utils.development.js:45:7)
      at actWithWarning (node_modules/react-dom/cjs/react-dom-test-utils.development.js:1736:7)
      at node_modules/@testing-library/react/dist/act-compat.js:63:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:159:26)
      at render (node_modules/@testing-library/react/dist/pure.js:246:10)
      at Object.<anonymous> (src/components/ExcelUploader/ExcelUploader.test.tsx:20:11)

    console.error
      Warning: An update to ExcelUploader inside a test was not wrapped in act(...).
      
      When testing, code that causes React state updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at ExcelUploader (/workspaces/Excel-workout/src/components/ExcelUploader/ExcelUploader.tsx:11:3)

      43 |       onUploadError?.(err instanceof Error ? err : new Error(message));
      44 |     } finally {
    > 45 |       setIsLoading(false);
         |       ^
      46 |     }
      47 |   }, [onUploadSuccess, onUploadError]);
      48 |

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at setIsLoading (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at src/components/ExcelUploader/ExcelUploader.tsx:45:7

  ● ExcelUploader › handles invalid file type

    TestingLibraryElementError: Found multiple elements with the text of: Choose Excel file

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<input[39m
      [33maccept[39m=[32m".xlsx,.xls"[39m
      [33maria-describedby[39m=[32m"upload-error"[39m
      [33maria-label[39m=[32m"Choose Excel file"[39m
      [33mclass[39m=[32m"fileInput"[39m
      [33mtype[39m=[32m"file"[39m
    [36m/>[39m

    Ignored nodes: comments, script, style
    [36m<input[39m
      [33maccept[39m=[32m".xlsx,.xls"[39m
      [33maria-label[39m=[32m"Choose Excel file"[39m
      [33mclass[39m=[32m"fileInput"[39m
      [33mtype[39m=[32m"file"[39m
    [36m/>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33maria-label[39m=[32m"Excel file upload"[39m
          [33mclass[39m=[32m"container"[39m
          [33mrole[39m=[32m"region"[39m
        [36m>[39m
          [36m<label[39m
            [33mclass[39m=[32m"uploadLabel"[39m
          [36m>[39m
            [36m<input[39m
              [33maccept[39m=[32m".xlsx,.xls"[39m
              [33maria-describedby[39m=[32m"upload-error"[39m
              [33maria-label[39m=[32m"Choose Excel file"[39m
              [33mclass[39m=[32m"fileInput"[39m
              [33mtype[39m=[32m"file"[39m
            [36m/>[39m
            [36m<span[39m
              [33mclass[39m=[32m"uploadButton"[39m
            [36m>[39m
              [0mChoose Excel File[0m
            [36m</span>[39m
          [36m</label>[39m
          [36m<div[39m
            [33mclass[39m=[32m"helpText"[39m
          [36m>[39m
            [0mSupported formats: .xlsx, .xls[0m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<div>[39m
        [36m<div[39m
          [33maria-label[39m=[32m"Excel file upload"[39m
          [33mclass[39m=[32m"container"[39m
          [33mrole[39m=[32m"region"[39m
        [36m>[39m
          [36m<label[39m
            [33mclass[39m=[32m"uploadLabel"[39m
          [36m>[39m
            [36m<input[39m
              [33maccept[39m=[32m".xlsx,.xls"[39m
              [33maria-label[39m=[32m"Choose Excel file"[39m
              [33mclass[39m=[32m"fileInput"[39m
              [33mtype[39m=[32m"file"[39m
            [36m/>[39m
            [36m<span[39m
              [33mclass[39m=[32m"uploadButton"[39m
            [36m>[39m
              [0mChoose Excel File[0m
            [36m</span>[39m
          [36m</label>[39m
          [36m<div[39m
            [33mclass[39m=[32m"helpText"[39m
          [36m>[39m
            [0mSupported formats: .xlsx, .xls[0m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      79 |     render(<ExcelUploader />);
      80 |     
    > 81 |     const input2 = screen.getByLabelText('Choose Excel file');
         |                           ^
      82 |     fireEvent.change(input2, { target: { files: [file] } });
      83 |     
      84 |     await waitFor(() => {

      at Object.getElementError (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/config.js:37:19)
      at getElementError (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:20:35)
      at getMultipleElementsFoundError (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:23:10)
      at node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:55:13
      at getByLabelText (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:95:19)
      at Object.<anonymous> (src/components/ExcelUploader/ExcelUploader.test.tsx:81:27)

  ● ExcelUploader › handles parsing errors

    TestingLibraryElementError: Found multiple elements with the text of: Choose Excel file

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<input[39m
      [33maccept[39m=[32m".xlsx,.xls"[39m
      [33maria-describedby[39m=[32m"upload-error"[39m
      [33maria-label[39m=[32m"Choose Excel file"[39m
      [33mclass[39m=[32m"fileInput"[39m
      [33mtype[39m=[32m"file"[39m
    [36m/>[39m

    Ignored nodes: comments, script, style
    [36m<input[39m
      [33maccept[39m=[32m".xlsx,.xls"[39m
      [33maria-label[39m=[32m"Choose Excel file"[39m
      [33mclass[39m=[32m"fileInput"[39m
      [33mtype[39m=[32m"file"[39m
    [36m/>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33maria-label[39m=[32m"Excel file upload"[39m
          [33mclass[39m=[32m"container"[39m
          [33mrole[39m=[32m"region"[39m
        [36m>[39m
          [36m<label[39m
            [33mclass[39m=[32m"uploadLabel"[39m
          [36m>[39m
            [36m<input[39m
              [33maccept[39m=[32m".xlsx,.xls"[39m
              [33maria-describedby[39m=[32m"upload-error"[39m
              [33maria-label[39m=[32m"Choose Excel file"[39m
              [33mclass[39m=[32m"fileInput"[39m
              [33mtype[39m=[32m"file"[39m
            [36m/>[39m
            [36m<span[39m
              [33mclass[39m=[32m"uploadButton"[39m
            [36m>[39m
              [0mChoose Excel File[0m
            [36m</span>[39m
          [36m</label>[39m
          [36m<div[39m
            [33mclass[39m=[32m"helpText"[39m
          [36m>[39m
            [0mSupported formats: .xlsx, .xls[0m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<div>[39m
        [36m<div[39m
          [33maria-label[39m=[32m"Excel file upload"[39m
          [33mclass[39m=[32m"container"[39m
          [33mrole[39m=[32m"region"[39m
        [36m>[39m
          [36m<label[39m
            [33mclass[39m=[32m"uploadLabel"[39m
          [36m>[39m
            [36m<input[39m
              [33maccept[39m=[32m".xlsx,.xls"[39m
              [33maria-label[39m=[32m"Choose Excel file"[39m
              [33mclass[39m=[32m"fileInput"[39m
              [33mtype[39m=[32m"file"[39m
            [36m/>[39m
            [36m<span[39m
              [33mclass[39m=[32m"uploadButton"[39m
            [36m>[39m
              [0mChoose Excel File[0m
            [36m</span>[39m
          [36m</label>[39m
          [36m<div[39m
            [33mclass[39m=[32m"helpText"[39m
          [36m>[39m
            [0mSupported formats: .xlsx, .xls[0m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      109 |     render(<ExcelUploader />);
      110 |     
    > 111 |     const input2 = screen.getByLabelText('Choose Excel file');
          |                           ^
      112 |     fireEvent.change(input2, { target: { files: [file] } });
      113 |     
      114 |     await waitFor(() => {

      at Object.getElementError (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/config.js:37:19)
      at getElementError (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:20:35)
      at getMultipleElementsFoundError (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:23:10)
      at node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:55:13
      at getByLabelText (node_modules/@testing-library/react/node_modules/@testing-library/dom/dist/query-helpers.js:95:19)
      at Object.<anonymous> (src/components/ExcelUploader/ExcelUploader.test.tsx:111:27)

PASS src/features/excelParsing/excelParser.test.ts
  ● Console

    console.error
      Error parsing Excel file: Error: No data found in the Excel file (or file is too short).
          at parseExcelFile (/workspaces/Excel-workout/src/features/excelParsing/excelParser.ts:20:13)
          at Object.<anonymous> (/workspaces/Excel-workout/src/features/excelParsing/excelParser.test.ts:49:9)

      164 |
      165 |   } catch (error: any) {
    > 166 |     console.error("Error parsing Excel file:", error);
          |             ^
      167 |     throw new Error(`Error parsing Excel file: ${error.message || error}`);
      168 |   }
      169 | }

      at parseExcelFile (src/features/excelParsing/excelParser.ts:166:13)
      at Object.<anonymous> (src/features/excelParsing/excelParser.test.ts:49:9)

    console.warn
      Row 4 is missing an exercise name and might be skipped.

      116 |
      117 |       if (!exercise.name) {
    > 118 |           console.warn(`Row ${rowIndex + 3} is missing an exercise name and might be skipped.`); // +3 because of skipping first two rows
          |                   ^
      119 |       }
      120 |       return exercise as Exercise;
      121 |     }).filter(exercise => exercise.name !== undefined) as Exercise[];

      at map (src/features/excelParsing/excelParser.ts:118:19)
          at Array.map (<anonymous>)
      at parseExcelFile (src/features/excelParsing/excelParser.ts:81:44)
      at Object.<anonymous> (src/features/excelParsing/excelParser.test.ts:182:20)

    console.error
      Error parsing Excel file: Error: Missing header row in the Excel file.
          at parseExcelFile (/workspaces/Excel-workout/src/features/excelParsing/excelParser.ts:33:13)
          at Object.<anonymous> (/workspaces/Excel-workout/src/features/excelParsing/excelParser.test.ts:225:7)

      164 |
      165 |   } catch (error: any) {
    > 166 |     console.error("Error parsing Excel file:", error);
          |             ^
      167 |     throw new Error(`Error parsing Excel file: ${error.message || error}`);
      168 |   }
      169 | }

      at parseExcelFile (src/features/excelParsing/excelParser.ts:166:13)
      at Object.<anonymous> (src/features/excelParsing/excelParser.test.ts:225:7)

    console.error
      Error parsing Excel file: Error: Missing required 'Exercise' column in the Excel file.
          at parseExcelFile (/workspaces/Excel-workout/src/features/excelParsing/excelParser.ts:77:13)
          at Object.<anonymous> (/workspaces/Excel-workout/src/features/excelParsing/excelParser.test.ts:283:7)

      164 |
      165 |   } catch (error: any) {
    > 166 |     console.error("Error parsing Excel file:", error);
          |             ^
      167 |     throw new Error(`Error parsing Excel file: ${error.message || error}`);
      168 |   }
      169 | }

      at parseExcelFile (src/features/excelParsing/excelParser.ts:166:13)
      at Object.<anonymous> (src/features/excelParsing/excelParser.test.ts:283:7)


Test Suites: 3 failed, 1 passed, 4 total
Tests:       7 failed, 18 passed, 25 total
Snapshots:   0 total
Time:        4.524 s
Ran all test suites.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            console.error
    Warning: `ReactDOMTestUtils.act` is deprecated in favor of `React.act`. Import `act` from `react` instead of `react-dom/test-utils`. See https://react.dev/warnings/react-dom-test-utils for more info.

      18 |
      19 |   it('renders upload button and help text', () => {
    > 20 |     render(<ExcelUploader />);
         |           ^
      21 |     
      22 |     expect(screen.getByLabelText('Choose Excel file')).toBeInTheDocument();
      23 |     expect(screen.getByText('Choose Excel File')).toBeInTheDocument();

      at printWarning (node_modules/react-dom/cjs/react-dom-test-utils.development.js:71:30)
      at error (node_modules/react-dom/cjs/react-dom-test-utils.development.js:45:7)
      at actWithWarning (node_modules/react-dom/cjs/react-dom-test-utils.development.js:1736:7)
      at node_modules/@testing-library/react/dist/act-compat.js:63:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:159:26)
      at render (node_modules/@testing-library/react/dist/pure.js:246:10)
      at Object.<anonymous> (src/components/ExcelUploader/ExcelUploader.test.tsx:20:11)
      at TestScheduler.scheduleTests (node_modules/@jest/core/build/TestScheduler.js:333:13)
      at runJest (node_modules/@jest/core/build/runJest.js:404:19)

  console.error
    Warning: An update to ExcelUploader inside a test was not wrapped in act(...).
    
    When testing, code that causes React state updates should be wrapped into act(...):
    
    act(() => {
      /* fire events that update state */
    });
    /* assert on the output */
    
    This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
        at ExcelUploader (/workspaces/Excel-workout/src/components/ExcelUploader/ExcelUploader.tsx:11:3)

      43 |       onUploadError?.(err instanceof Error ? err : new Error(message));
      44 |     } finally {
    > 45 |       setIsLoading(false);
         |       ^
      46 |     }
      47 |   }, [onUploadSuccess, onUploadError]);
      48 |

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at setIsLoading (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at src/components/ExcelUploader/ExcelUploader.tsx:45:7

FAIL src/components/ExcelUploader/ExcelUploader.test.tsx
  ExcelUploader
    ✓ renders upload button and help text (29 ms)
    ✓ shows loading state while processing (111 ms)
    ✓ handles successful file upload (13 ms)
    ✕ handles invalid file type (3 ms)
    ✕ handles parsing errors (4 ms)
    ✓ clears the input after successful upload (16 ms)

  ● ExcelUploader › handles invalid file type

    ReferenceError: act is not defined

      67 |     const file = new File([''], 'test.txt', { type: 'text/plain' });
      68 |     
    > 69 |     await act(async () => {
         |     ^
      70 |       fireEvent.change(input, { target: { files: [file] } });
      71 |     });
      72 |     

      at Object.<anonymous> (src/components/ExcelUploader/ExcelUploader.test.tsx:69:5)
      at TestScheduler.scheduleTests (node_modules/@jest/core/build/TestScheduler.js:333:13)
      at runJest (node_modules/@jest/core/build/runJest.js:404:19)

  ● ExcelUploader › handles parsing errors

    ReferenceError: act is not defined

      104 |     const file = new File([''], 'test.xlsx', { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
      105 |     
    > 106 |     await act(async () => {
          |     ^
      107 |       fireEvent.change(input, { target: { files: [file] } });
      108 |     });
      109 |     

      at Object.<anonymous> (src/components/ExcelUploader/ExcelUploader.test.tsx:106:5)
      at TestScheduler.scheduleTests (node_modules/@jest/core/build/TestScheduler.js:333:13)
      at runJest (node_modules/@jest/core/build/runJest.js:404:19)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 4 passed, 6 total
Snapshots:   0 total
Time:        1.608 s
Ran all test suites related to changed files.

